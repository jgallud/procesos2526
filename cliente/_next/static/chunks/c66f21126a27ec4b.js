(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71851,e=>{"use strict";var a=e.i(38949),t=e.i(37189),r=e.i(69243),l=e.i(10811),o=e.i(54823),s=e.i(6686);function n({tablero:e,onClickCelda:a}){let r=e.length;return(0,t.jsx)("div",{className:"relative inline-grid border-4 border-black bg-yellow-300 rounded-lg",style:{gridTemplateColumns:`repeat(${r}, 48px)`,gridTemplateRows:`repeat(${r}, 48px)`},children:e.map((e,l)=>e.map((e,o)=>{let s=1===e,n=2===e;return(0,t.jsxs)("div",{onClick:()=>a(o,l),className:"relative w-12 h-12 cursor-pointer",children:[l<r-1&&(0,t.jsx)("div",{className:"absolute top-1/2 left-0 w-full h-[1px] bg-black"}),o<r-1&&(0,t.jsx)("div",{className:"absolute left-1/2 top-0 h-full w-[1px] bg-black"}),(s||n)&&(0,t.jsx)("div",{className:"absolute w-10 h-10 rounded-full",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:s?"black":"white",border:n?"1px solid #333":"none"}})]},`${o}-${l}`)}))})}function i({tablero:e,onClickCelda:a}){let r=e.length;return(0,t.jsxs)("div",{className:"relative rounded-lg mx-auto w-[360px] h-[360px]",style:{backgroundColor:"#DEB887"},children:[e.map((e,a)=>(0,t.jsx)("div",{className:"absolute left-0 right-0 h-0.5",style:{top:`${100/r*(a+.5)}%`,backgroundColor:"#8B5A2B"}},`h-${a}`)),e[0].map((e,a)=>(0,t.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5",style:{left:`${100/r*(a+.5)}%`,backgroundColor:"#8B5A2B"}},`v-${a}`)),e.map((e,l)=>e.map((e,o)=>{let s=1===e?"black":2===e?"white":null;return(0,t.jsx)("div",{onClick:()=>a(l,o),className:"absolute w-10 h-10 cursor-pointer",style:{top:`${100/r*(l+.5)}%`,left:`${100/r*(o+.5)}%`,transform:"translate(-50%, -50%)",zIndex:10},children:s&&(0,t.jsx)("div",{className:"w-10 h-10 rounded-full shadow-md",style:{backgroundColor:s,border:"white"===s?"1px solid #333":"none"}})},`${l}-${o}`)})),[[2,2],[2,6],[6,2],[6,6],[4,4]].map(([e,a],l)=>(0,t.jsx)("div",{className:"absolute w-2 h-2 bg-brown-700 rounded-full",style:{top:`${100/r*(e+.5)}%`,left:`${100/r*(a+.5)}%`,transform:"translate(-50%, -50%)",zIndex:5}},`hoshi-${l}`))]})}function d(e,a,t=9){return[[e-1,a],[e+1,a],[e,a-1],[e,a+1]].filter(([e,a])=>e>=0&&e<t&&a>=0&&a<t)}function c(e,a,t,r=new Set){let l=e[a][t],o=[[a,t]],s=[];for(;o.length;){let[a,t]=o.pop(),n=`${a},${t}`;r.has(n)||(r.add(n),s.push([a,t]),d(a,t).forEach(([a,t])=>{e[a][t]===l&&o.push([a,t])}))}return s}function u(e,a){let t=new Set;return a.forEach(([a,r])=>{d(a,r).forEach(([a,r])=>{0===e[a][r]&&t.add(`${a},${r}`)})}),t.size}function x(e,a,t,r){if(0!==e[a][t])return{valida:!1};let l=e.map(e=>[...e]);l[a][t]=r;let o=1===r?2:1,s=0;d(a,t).forEach(([e,a])=>{if(l[e][a]===o){let t=c(l,e,a);0===u(l,t)&&(s+=t.length,t.forEach(([e,a])=>{l[e][a]=0}))}});let n=c(l,a,t),i=u(l,n);return 0===i&&0===s?{valida:!1}:{valida:!0,tablero:l,capturas:s,libertades:i}}function b(){let[e,d]=(0,r.useState)("");a.default.env.urlConfirmar;let[c,u]=(0,r.useState)(null),[b,m]=(0,r.useState)(!0),[f,h]=(0,r.useState)(""),[p,g]=(0,r.useState)(""),[j,y]=(0,r.useState)([]),[v,N]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),[k,A]=(0,r.useState)({tablero:Array(9).fill(null).map(()=>Array(9).fill(0)),turno:"1"}),[P,S]=(0,r.useState)("black"),[$,E]=(0,r.useState)(!1),[T,B]=(0,r.useState)({tablero:Array(9).fill(null).map(()=>Array(9).fill(0)),turno:1,capturas:{negro:0,blanco:0}}),[I,z]=(0,r.useState)(null),[R,U]=(0,r.useState)(null),O=(0,o.useRouter)(),L=(0,s.useSocket)();function D(){B(e=>{if(2!==e.turno)return e;let a=function(e,a=9){let t=null,r=-1/0;for(let l=0;l<a;l++)for(let o=0;o<a;o++){let a=x(e,l,o,2);if(!a.valida)continue;let s=Math.abs(l-4)+Math.abs(o-4),n=100*a.capturas+2*a.libertades-s;n>r&&(r=n,t=[l,o])}return t}(e.tablero);if(!a)return e;let[t,r]=a,l=x(e.tablero,t,r,2);return{...e,tablero:l.tablero,turno:1,capturas:{...e.capturas,blanco:e.capturas.blanco+l.capturas}}})}(0,r.useEffect)(()=>{(async()=>{try{let e=document.cookie.includes("email"),a=Object.fromEntries(document.cookie.split("; ").map(e=>{let[a,t]=e.split("=");return[a,decodeURIComponent(t)]}));console.log("Cookies en dashboard:",a),e?(console.log("Datos de usuario:",a),u(a),d(a.email),m(!1)):O.push("/")}catch(e){console.error("Error verificando sesiÃ³n",e),O.push("/")}})()},[L]),(0,r.useEffect)(()=>{if(L)return L.on("partidaCreada",e=>{h(e.codigo),S(e.color),N(!0)}),L.on("errorPartida",e=>alert(e)),L.on("actualizarListaPartidas",e=>y(e)),L.on("unidoAPartida",e=>{h("object"==typeof e?e.codigo:e),S(e.color)}),L.on("iniciarPartida",e=>{y([]),N(!0),C(!0),A({tablero:e.tablero,turno:e.turno})}),L.on("estadoPartida",e=>{A({tablero:e.tablero,turno:e.turno})}),L.on("jugadaRealizada",e=>{let a=e.tablero.map(e=>[...e]);A({...e,tablero:a})}),L.on("jugadaInvalida",({motivo:e})=>{"NO_TU_TURNO"===e&&(0,l.toast)("No es tu turno"),"CASILLA_OCUPADA"===e&&(0,l.toast)("Esa casilla ya estÃ¡ ocupada")}),L.on("partidaAbandonada",e=>{e.id!==L.id&&z("El otro jugador ha abandonado la partida"),N(!1),h(""),g(""),y([]),S(""),A({tablero:Array(9).fill(Array(9).fill(null)),turno:null})}),()=>{L.off("partidaCreada"),L.off("errorPartida"),L.off("actualizarListaPartidas"),L.off("unidoAPartida"),L.off("iniciarPartida"),L.off("estadoPartida"),L.off("jugadaRealizada"),L.off("jugadaInvalida"),L.off("partidaAbandonada")}},[L]);let J=()=>{L&&L.emit("abandonarPartida",{email:e,codigo:f}),h(""),N(!1),C(!1),A({tablero:Array(9).fill(Array(9).fill(null)),turno:null}),S(null),E(!1)};return((0,r.useEffect)(()=>{if(!I)return;let e=setTimeout(()=>z(null),2e3);return()=>clearTimeout(e)},[I]),b)?(0,t.jsx)("div",{className:"p-10 text-center",children:"Verificando sesiÃ³n..."}):(0,t.jsxs)("div",{className:"max-w-5xl mx-auto animate-in fade-in duration-700",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8 bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-black text-gray-800 tracking-tighter uppercase",children:v||$?"ðŸ•¹ï¸ En Partida":"ðŸŒ Control de Partidas"}),(0,t.jsx)("p",{className:"text-gray-500 text-sm font-medium",children:e})]}),f&&(0,t.jsxs)("div",{className:"flex flex-col items-end",children:[(0,t.jsx)("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"CÃ³digo Sala"}),(0,t.jsx)("span",{className:"text-2xl font-mono font-black text-indigo-600 tracking-widest leading-none",children:f})]})]}),v&&(0,t.jsxs)("div",{className:"bg-gray-900 rounded-[3rem] p-12 min-h-[400px] flex flex-col items-center justify-center border-[12px] border-gray-800 shadow-2xl",children:[!w&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-white text-3xl font-black mb-8",children:"Esperando al otro jugador..."}),(0,t.jsx)("button",{onClick:J,className:"mt-6 text-gray-400 hover:text-red-400 font-bold",children:"Abandonar partida"})]}),w&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:1===k.turno?"black":"white",border:2===k.turno?"1px solid #333":"none"}}),(0,t.jsxs)("span",{className:"text-white font-bold text-lg",children:["Turno: ",1===k.turno?"Negras":"Blancas"]})]}),(0,t.jsx)(n,{tablero:k.tablero,turno:k.turno,miColor:P,onClickCelda:(a,t)=>{P===k.turno&&L.emit("colocarPiedra",{email:e,codigo:f,x:a,y:t})}}),(0,t.jsx)("button",{onClick:J,className:"mt-8 text-gray-400 hover:text-red-400 font-bold",children:"Abandonar partida"})]})]}),!v&&$&&T&&(0,t.jsxs)("div",{className:"bg-gray-900 rounded-[3rem] p-12 min-h-[400px] flex flex-col items-center justify-center border-[12px] border-gray-800 shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex gap-8 mb-6 text-white font-bold",children:[(0,t.jsxs)("div",{children:["âš« Negro: ",T.capturas.negro]}),(0,t.jsxs)("div",{children:["âšª Blanco: ",T.capturas.blanco]})]}),(0,t.jsx)(i,{tablero:T.tablero,onClickCelda:function(e,a){B(t=>{if(1!==t.turno)return t;let r=x(t.tablero,e,a,1);return r.valida?{...t,tablero:r.tablero,turno:2,capturas:{...t.capturas,negro:t.capturas.negro+r.capturas}}:t}),setTimeout(D,400)}}),(0,t.jsx)("button",{onClick:()=>E(!1),className:"mt-8 text-gray-400 hover:text-red-400 font-bold",children:"Abandonar partida"})]}),!v&&!$&&(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white p-8 rounded-3xl border border-gray-100 shadow-sm",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Nueva Partida"}),(0,t.jsx)("p",{className:"text-gray-500 mb-6 text-sm",children:"Crea una sala privada y espera a que otros se unan."}),(0,t.jsx)("button",{onClick:()=>{L&&L.emit("crearPartida",{email:e})},disabled:!!f,className:`w-full py-4 rounded-xl font-bold transition-all ${f?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700 shadow-indigo-200 shadow-lg"}`,children:f?"Esperando oponente...":"Crear Sala Ahora"})]}),(0,t.jsxs)("div",{className:"bg-white p-8 rounded-3xl border border-gray-100 shadow-sm",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Unirse con CÃ³digo"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",placeholder:"EJ: AB1234",value:p,onChange:e=>g(e.target.value),className:"flex-1 bg-gray-50 rounded-xl px-4 font-mono font-bold"}),(0,t.jsx)("button",{onClick:()=>L.emit("unirAPartida",{email:e,codigo:p}),className:"bg-gray-900 text-white px-6 py-4 rounded-xl font-bold",children:"Ir"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-8 rounded-3xl border border-gray-100 shadow-sm",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Partida contra la MÃ¡quina"}),(0,t.jsx)("p",{className:"text-gray-500 mb-6 text-sm",children:"Juega un Go 9x9 contra la IA local."}),(0,t.jsx)("button",{onClick:()=>{let e=Array(9).fill(null).map(()=>Array(9).fill(0));B({tablero:e,turno:1,capturas:{negro:0,blanco:0}}),E(!0),console.log("estadoIA despuÃ©s de iniciar:",e)},className:"w-full py-4 rounded-xl font-bold bg-green-600 text-white hover:bg-green-700 shadow-green-200 shadow-lg",children:"Jugar ahora"})]})]}),I&&(0,t.jsx)("div",{className:"fixed top-6 right-6 z-50 bg-gray-900 text-white px-6 py-3 rounded-xl shadow-xl",children:I})]})}e.s(["default",()=>b],71851)}]);